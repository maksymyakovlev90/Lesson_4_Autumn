<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Homework</title>
</head>
<body>
    <header><a href="https://codeguida.com/post/1095">>codeguida</a></header>
    <main>
        <h1>CSS font-display: Майбутнє рендерингу шрифтів у вебі</h1>
        <br>
        <p>Одним із недоліків використання веб-шрифтів, є те, що у випадку недоступності шрифту на пристрої користувача, його необхідно завантажувати. Це означає, що до того як шрифт стане доступним, браузер повинен вирішити як відобразити будь-який блок тексту, який використовує цей шрифт. І це потрібно зробити таким чином, щоб не вплинути на досвід користування.</p>
        <br>
        <p>З часом, браузери прийняли декілька <span>стратегій</span> для пом’якшення цієї проблеми. Але вони роблять це <span>по-різному</span> і поза контролем розробників, які повинні були <span>придумати</span> шляхи вирішення цих питань.</p>
        <br>
        <p>Вітайте <span>дескриптор font-display</span> для правила <mark>@font-face</mark>. Ця CSS функція надає можливість стандартизувати таку поведінку і надає більше контролю розробникам.</p>
        <br>
        <h2>Використання <mark>font-display</mark></h2>
        <br>
        <p>Перед тим як зануритись у деталі, коротко розглянемо як можна використовувати <mark>font-display</mark> у вашому CSS.
        </p>
        <br>
        <p>Насамперед, <mark>font-display</mark> не є CSS властивістю, а, як було згадано у вступі, це <span>дескриптор</span> правила <mark>@font-face</mark>. Це означає, що його потрібно використовувати всередині правила <mark>@font-face</mark>:</p>
        <br>
        <div class="example">
            @font-face {<br>
                font-family: 'Saira Condensed';<br>
                src: url(fonts/sairacondensed.woff2) format('woff2');<br>
                font-display: swap;<br>
              }
        </div>
        <br>
        <p>У цьому фрагменті коду я встановлюю значення <mark>swap</mark> для шрифту <strong>Saira Condensed</strong>.</p>
        <br>
        <p>Ключовими словами для всіх доступних значень є:</p>
        <br>
        <ul>
            <li><b>auto</b></li>
            <li><b>block</b></li>
            <li><b>swap</b></li>
            <li><b>fallback</b></li>
            <li><b>optional</b></li>
        </ul>
        <br>
        <p>Початковим значенням для <mark>font-display</mark> є <mark>auto</mark>.</p>
        <br>
        <p>У наступних розділах я детально розгляну кожне із цих значень. Але спочатку погляньмо на період часу, який браузер використовує для визначення шрифту, що відображатиметься. Обговорюючи кожне з цих значень, я поясню різні аспекти часової шкали та як вони поводяться для кожного значення.</p>
        <br>
        <h2>Часова шкала <mark>font-display</mark></h2>
        <br>
        <p>В основі цієї функції лежить концепція <strong>часової шкали font-display</strong>. Час завантаження шрифту, починаючи від запиту і закінчуючи успішним завантаженням або невдачею, можна розділити на три послідовні фази, які визначають, як браузер повинен відобразити текст. Ці три фази такі:</p>
        <br>
        <ol>
            <li><strong>Фаза блокування</strong>. У цей час браузер відображає текст із невидимим резервним шрифтом. Якщо викликаний шрифт успішно завантажується, текст рендериться ще раз із цим шрифтом. Невидимий резервний шрифт виступає як порожній заповнювач для тексту. Це зменшує зміни макету при виконанні повторного рендерингу.</li>
            <li><strong>Фаза зміни</strong>. Якщо потрібний шрифт ще не доступний, використовується резервний шрифт, але цього разу текст відображається. Знову ж таки, як тільки потрібний шрифт завантажиться, його буде використано.
            </li>
            <li><strong>Фаза відмови</strong>. Якщо шрифт не стає доступним, браузер не чекає на нього, а на час поточного відвідування сторінки, текст буде відображено за допомогою резервного шрифту. Зауважте, що це не обов'язково означає, що завантаження шрифту переривається; замість цього браузер може продовжити його завантаження, щоб шрифт був готовий до використання під час наступних відвідувань сторінки тим самим користувачем.</li>
        </ol>
        <br>
        <p>Регулювання тривалості таких періодів дає змогу налаштовувати власну стратегію рендерингу тексту. Зокрема, її можна зменшувати до нуля або розширювати до нескінченності. Я покажу як це зробити у наступних розділах.</p>
        <br>
        <p>Але тривалість цих періодів не може явно встановлюватись розробником. Ця можливість була розглянута на ранній стадії специфікації, але була <span>виключена</span>. Натомість, як зазначено в попередньому розділі, надано набір визначених значень ключових слів, які можуть обробляти більшість випадків використання.</p>
        <br>
        <p>Подивімося, як кожне з цих ключових слів керує процесом завантаження та відображення шрифтів.</p>
        <br>
        <h2><mark>font-display: auto</mark>
        </h2>
        <br>
        <p>Це значення вказує браузеру прийняти поведінку відображення шрифту за замовчуванням. Часто ця стратегія є схожою до наступного значення, <mark>block</mark>.</p>
        <br>
        <h2><mark>font-display: block</mark></h2>
        <br>
        <p>З цим значенням, після короткої фази блокування (специфікація рекомендує 3 секунди), фаза зміни розширюється до нескінченності. Це означає, що за цієї обставини фаза відмови відсутня.</p>
        <br>
        <p>Під час короткого очікування потрібного шрифту, браузер рендерить текст з невидимим резервним шрифтом; після цього, якщо шрифт і досі недоступний, резервний шрифт стає видимим, і коли завантаження завершується, браузер повторно рендерить текст із потрібним шрифтом.</p>
        <br>
        <p>На початку завантаження сторінки заголовок невидимий, але він присутній у DOM. Приблизно через три секунди, якщо шрифт ще не доступний, текст стає видимим із резервним шрифтом. У демонстрації я відтворюю умови слабкого інтернет-з’єднання, використовуючи функцію <span>дроселювання (throttling) пропускної здатності мережі</span> у Chrome DevTools. Нарешті, коли шрифт вдається завантажити, заголовок буде повторно відображено з ним.</p>
        <br>
        <h2><mark>font-display: swap</mark></h2>
        <br>
        <p>З цим значенням фаза блокування згортається до 0, а фаза зміни розширюється до нескінченності. Тому тут також відсутня фаза відмови.</p>
        <br>
        <p>Іншими словами, браузер не чекає на шрифт, а замість цього негайно відображає текст із резервним шрифтом; тоді, коли шрифт є доступним, текст з ним повторно рендериться.
        </p>
        <br>
        <h2><mark>font-display: fallback</mark></h2>
        <br>
        <p>Це перше значення, яке включає фазу відмови. Після дуже короткої фази блокування (рекомендовано 100 мс), фаза зміни тепер має коротку тривалість (рекомендовано 3 с). В результаті, якщо потрібний шрифт не буде готовий наприкінці цього періоду, на час відвідування сторінки текст відображатиметься за допомогою резервного шрифту. Це дозволяє не відволікати користувача пізньою заміною макету.</p>
        <br>
        <h2><mark>font-display: optional</mark></h2>
        <br>
        <p>Коли я вперше прочитав специфікацію, я виявив, що назви, призначені для стратегій відображення шрифтів, не зовсім зрозумілі. Це навіть зазначено в самій специфікації, що <span>передбачає</span> у майбутній версії використання назв, які краще ілюструють заплановане використання кожної стратегії.
        </p>
        <br>
        <p>Запропоновано такі альтернативи:</p>
        <br>
        <ul>
            <li><mark>requires</mark> для <mark>block</mark></li>
            <li><mark>important</mark> для <mark>swap</mark>
            </li>
            <li><mark>preferable</mark> для <mark>fallback</mark>
            </li>
        </ul>
        <br>
        <p>Але значення optional залишиться незмінним. Це значення добре передає суть поведінки, яку воно викликає. У цьому випадку шрифт вважається необов'язковим для відтворення сторінки, по суті, кажучи браузеру: якщо шрифт готовий, використай його, інакше він не має значення, продовжуй з резервним шрифтом; шрифт може бути готовим для майбутніх відвідувань сторінки.</p>
        <br>
        <p>З цим значенням, часова шкала font-display має коротку фазу блокування (у специфікації рекомендовано 100 мс) та фазу зміни з нульовою тривалістю. Отже, фаза відмови йде одразу після фази блокування, що означає, якщо шрифт не готовий відразу, його не буде використано під час цього відвідування сторінки. Але шрифт може бути повністю завантажений у фоновому режимі, і він стане доступним для негайного відтворення на майбутніх завантаженнях сторінки.</p>
        <br>
        <p>Але тут слід зазначити, що, особливо в умовах слабкого інтернет-з’єднання, користувацький агент може скасувати або навіть не розпочинати завантаження шрифтів. Це має на меті виключити зайвий вплив на якість мережевого з’єднання. Тому сайт все ще можна використовувати, але шрифт не буде доступний під час майбутніх завантажень сторінки.</p>
        <br>
        <h2>Про резервний шрифт</h2>
        <br>
        <p>Резервний шрифт – перший доступний шрифт у стеку шрифтів, визначений за допомогою властивості <mark>font-family</mark> у відповідному елементі.</p>
        <br>
        <p>Наприклад, на тестовій сторінці значення <mark>font-family</mark> для заголовка є:</p>
        <br>
        <div class="example">
            h1 {<br>
                font-family: 'Saira Condensed', Arial, "Helvetica Neue", Helvetica, sans-serif;<br>
              }
        </div>
        <br>
        <h2>Підтримка</h2>
        <br>
        <p>На час написання статті, рівень підтримки дескриптора <mark>font-display</mark> наступний:</p>
        <br>
        <ul>
            <li>Chrome підтримує його з <span>версії 60</span></li>
            <li>Opera підтримує з версії 47
            </li>
            <li>Для Firefox він <span>у розробці</span> та є доступним з вендорним префіксом з версії 46</li>
            <li>Щодо Safari, то згідно зі статусом Webkit платформи – він <span>у розробці</span></li>
            <li>Немає <span>жодних ознак</span> того, що Microsoft Edge буде підтримувати його в будь-який час незабаром. Існує <span>квиток</span> на сайті Microsoft Edge Developer Feedback, де можна проголосувати за реалізацію цієї функції.</li>
        </ul>    
            <br>
            <p>Для отримання найновішої інформації про підтримку зверніться до сайту <a href="https://caniuse.com/#feat=css-font-rendering-controls">caniuse.com</a></p>
        <br>
        <p>Варто згадати, що підтримку <mark>font-display</mark> не можна перевірити за допомогою функціональних запитів, оскільки, як зазначено вище, це не властивість CSS, а дескриптор шрифту. <span>У цьому питанні на GitHub</span> ви знайдете обговорення того, як правильно визначити цю функцію.</p>
        <br>
        <p>Як тільки було виявлено, що <mark>font-display</mark> не підтримується, існує декілька альтернативних варіантів, які можна використати, але це не стосується цієї статті. У статті Зака Летермана <span>«Комплексний довідник зі стратегій завантаження шрифтів»</span> представлено вичерпний огляд доступних рішень.</p>
        <br>
        <h2>Використання з Google Fonts</h2>
        <br>
        <p>Можливо ви помітили, що шрифт, який використовується на демонстраційній сторінці, – з Google Fonts, але він не завантажується звичайним способом, тобто посиланням на таблицю стилів, надану постачальником шрифтів. Замість цього я просто скопіював URL-адресу шрифту, знайденого в цій таблиці стилів, і використав цю адресу в моєму користувацькому правилі <mark>@font-face</mark>. Мені довелося це зробити, тому що, як видно з розділу використання, <mark>font-display</mark> повинен бути вказаний в правилі <mark>@font-face</mark>.
        </p>
        <br>
        <p>Чи є кращий спосіб підключення до Google Fonts? Чи будуть Google Fonts та інші компанії-розробники шрифтів підтримувати <mark>font-display</mark>?
        </p>
        <br>
        <p>Є <span>відкрите питання</span> на GіtHub репозиторії Google Fonts, де це обговорюється. Додайте +1, щоб показати свою зацікавленість у цьому питанні!
        </p>
        <br>
        <p>Також варто зазначити, що <span>CSS Fonts Module Level 4</span> пропонує використовувати <mark>font-display</mark> як дескриптор для <span>@font-function-values</span>, щоб дозволити розробникам встановлювати політику відображення для правил <mark>@font-face</mark>, які не знаходяться безпосередньо під їхнім контролем. Але це ще не впроваджено жодним користувацьким агентом.
        </p>
    </main>
    <footer><a href="https://www.sitepoint.com/css-font-display-future-font-rendering-web/" target="_blank">>sitepoint</a></footer>
</body>
</html>